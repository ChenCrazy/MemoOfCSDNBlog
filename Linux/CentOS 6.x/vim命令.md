# Vim命令行模式
## 1.移动光标
* `k、j、h、l`&nbsp;&nbsp;&nbsp;&nbsp;      功能分别等同于上、下、左、右箭头键 
* `Ctrl+b`&nbsp;&nbsp;&nbsp;&nbsp;            在文件中向上移动一页（相当于 PageUp 键）
* `Ctrl+f`&nbsp;&nbsp;&nbsp;&nbsp;             在文件中向下移动一页（相当于 PageDown 键）
* `ctrl+u`&nbsp;&nbsp;&nbsp;&nbsp;             屏幕往后移动半页
* `ctrl+d`&nbsp;&nbsp;&nbsp;&nbsp;            屏幕往前移动半页
* `H`&nbsp;&nbsp;&nbsp;&nbsp;                   将光标移到屏幕的最上行（Highest） 
* `nH`&nbsp;&nbsp;&nbsp;&nbsp;                 将光标移到屏幕的第 n 行（如 2H： 将光标移到屏幕的第 2 行）
* `M`&nbsp;&nbsp;&nbsp;&nbsp;                  将光标移到屏幕的中间（Middle）
* `L`&nbsp;&nbsp;&nbsp;&nbsp;                   将光标移到屏幕的最下行（Lowest） 
* `nL`&nbsp;&nbsp;&nbsp;&nbsp;                 将光标移到屏幕的倒数第 n 行（如 3L：将光标移到屏幕的倒数第 3 行）
* `w`&nbsp;&nbsp;&nbsp;&nbsp;                  在指定行内右移光标，到下一个字的开头
* `e`&nbsp;&nbsp;&nbsp;&nbsp;                   在指定行内右移光标，到一个字的末尾
* `b`&nbsp;&nbsp;&nbsp;&nbsp;                   在指定行内左移光标，到前一个字的开头
* `0`&nbsp;&nbsp;&nbsp;&nbsp;                   数字0，左移光标，到本行的开头 
* `G`&nbsp;&nbsp;&nbsp;&nbsp;                  光标移动到文章的最后
* `nG`&nbsp;&nbsp;&nbsp;&nbsp;                光标移动到文章的第 n行（如8G：移动到文章的第 8行）
* `$`&nbsp;&nbsp;&nbsp;&nbsp;                   右移光标，到本行的末尾 
* `^`&nbsp;&nbsp;&nbsp;&nbsp;                   移动光标，到本行的第一个非空字符
## 2.替换和删除
* `rc`&nbsp;&nbsp;&nbsp;&nbsp;                  用 c 替换光标所指向的当前字符
* `nrc`&nbsp;&nbsp;&nbsp;&nbsp;                用 c 替换光标所指向的前 n 个字符（如 5rc： 用 c 替换光标所指向的前 5 个字符）
* `x`&nbsp;&nbsp;&nbsp;&nbsp;                   删除光标所在位置后面的一个字符 
* `nx`&nbsp;&nbsp;&nbsp;&nbsp;                 删除光标所在位置后面的 n 个字符（如 3x：删除光标所在位置后面的 3 个字符）
* `X`&nbsp;&nbsp;&nbsp;&nbsp;                  大写的 X，删除光标所在位置前面的一个字符
* `nX`&nbsp;&nbsp;&nbsp;&nbsp;                删除光标所在位置前面的 n 个字符（如 3X ： 删除光标所在位置前面的 3 个字符）
* `dd`&nbsp;&nbsp;&nbsp;&nbsp;                删除光标所在行，并去除空隙 
* `ndd`&nbsp;&nbsp;&nbsp;&nbsp;              从光标所在行开始删除 n 行内容，并去除空隙（如 3dd： 删除 3 行内容，并去除空隙） 
## 3.复制和粘贴
从正文中删除的内容（如字符、字或行）并没有真正丢失，而是被剪切并复制到了一个内存缓冲区中。用户可将其粘贴到正文中的指定位置。
* `p`&nbsp;&nbsp;&nbsp;&nbsp;                  小写字母 p，将缓冲区的内容粘贴到光标的后面
* `P`&nbsp;&nbsp;&nbsp;&nbsp;                  大写字母 P，将缓冲区的内容粘贴到光标的前面 
如果缓冲区的内容是字符或字，直接粘贴在光标的前面或后面；如果缓冲区的内容为整行正文则粘贴在当前光标所在行的上一行或下一行。

有时需要复制一段正文到新位置，同时保留原有位置的内容。这种情况下，首先应当把指定内容复制（而不是剪切）到内存缓冲区。完成这一操作的命令是：
* `yy`&nbsp;&nbsp;&nbsp;&nbsp;                 复制当前行到内存缓冲区
* `nyy`&nbsp;&nbsp;&nbsp;&nbsp;               复制 n 行内容到内存缓冲区（如 5yy： 复制 5 行内容到内存缓冲区）
## 4.搜索字符串
* `/str1`             正向搜索字符串 str1 
* `n`                  继续搜索，找出 str1 字符串下次出现的位置 
* `?str2`            反向搜索字符串 str2 
## 5.撤销和重复
* `u`&nbsp;&nbsp;&nbsp;&nbsp;                  撤消前一条命令的结果 
* `.`&nbsp;&nbsp;&nbsp;&nbsp;                   重复最后一条修改正文的命令 
## 6.文本选中
* `v`                  字符选中命令  
* `V`                  行选中命令
# 2.插入模式
## 1.进入插入模式
* `i`&nbsp;&nbsp;&nbsp;&nbsp;                   在光标左侧输入正文
* `a`&nbsp;&nbsp;&nbsp;&nbsp;                  在光标右侧输入正文
* `o`&nbsp;&nbsp;&nbsp;&nbsp;                  在光标所在行的下一行增添新行 
* `O`&nbsp;&nbsp;&nbsp;&nbsp;                 在光标所在行的上一行增添新行
* `I`&nbsp;&nbsp;&nbsp;&nbsp;                   在光标所在行的开头输入正文 
* `A`&nbsp;&nbsp;&nbsp;&nbsp;                 在光标所在行的末尾输入正文
## 2.退出插入模式
ESC 键或组合键Ctrl+[ 
# 3.底行模式
在vi 的底行模式下，可以使用复杂的命令。
## 1.退出命令
在命令模式下可以用 ZZ 命令退出 vi 编辑程序，该命令保存对正文所作的修改，覆盖原始文件。如果只需要退出编辑程序，而不打算保存编辑的内容，可用下面的命令：

* `: q`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在未作修改的情况下退出
* `: q!`&nbsp;&nbsp;&nbsp;&nbsp;放弃所有修改，退出编辑程序
## 2.行号和文件保存
* `: n`&nbsp;&nbsp;&nbsp;&nbsp;将光标移到第 n 行 
* `:set nu`&nbsp;&nbsp;&nbsp;&nbsp;显示行号 
* `:set nonu`&nbsp;&nbsp;取消行号显示

底行模式下，可以规定命令操作的行号范围。数值用来指定绝对行号；字符“.”表示光标所在行的行号；字符`"$"`表示正文最后一行的行号；简单的表达式，例如“.+5”表示当前行往下的*第5行。例如：

* `: .+5`&nbsp;&nbsp;               将光标移到当前行之后的第5行 
* `: $`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  将光标移到正文最后一行

在底行模式下，允许从文件中读取正文，或将正文写入文件。例如：
* `:w`                  将编辑的内容写入原始文件，用来保存编辑的中间结果 
* `:wq`                将编辑的内容写入原始文件并退出编辑程序（相当于 ZZ 命令） 
* `:w file`             将编辑的内容写入 file 文件，保持原有文件的内容不变 
* `:a,bw file`        将第 a 行至第 b 行的内容写入 file 文件 （如:1,.w file    将第 1 行至当前行写入 file 文件）
* `:r file`              读取 file 文件的内容，插入当前光标所在行的后面
* `:f file`              将当前文件重命名为 file 

## 3.字符串搜索
* `:/str/`               正向搜索，将光标移到下一个包含字符串 str 的行
* `:?str?`             反向搜索，将光标移到上一个包含字符串 str 的行

## 4.正文替换
* `:s/str1/str2/`          用字符串 str2 替换行中首次出现的字符串 str1 
* `:s/str1/str2/g`        用字符串 str2 替换行中所有出现的字符串 str1 
* `:.,$ s/str1/str2/g`   用字符串 str2 替换正文当前行到末尾所有出现的字符串 str1 
* `:1,$ s/str1/str2/g`  用字符串 str2 替换正文中所有出现的字符串 str1 
* `:g/str1/s//str2/g`    功能同上

从上述替换命令可以看到：g 放在命令末尾，表示对搜索字符串的每次出现进行替换；不加 g，表示只对搜索字符串的首次出现进行替换；g 放在命令开头，表示对正文中所有包含搜索字符串的行进行替换操作。

## 5.删除正文
* `:d`                      删除光标所在行 
* `:3d`                    删除第 3 行 
* `:.,$d`                  删除当前行至正文的末尾 
* `:/str1/,/str2/d`     删除从字符串 str1 到 str2 的所有行 

## 6.恢复文件
vi 在编辑某个文件时，会另外生成一个临时文件，这个文件的名称通常以 . 开头，并以 .swp 结尾。vi 在正常退出时，该文件被删除，若意外退出，而没有保存文件的最新修改内容，则可以使用恢复命令，也可以在启动 vi 时利用 -r 选项。

* `:recover`           恢复文件

# 4.选项设置
为控制不同的编辑功能，vi 提供了很多内部选项。利用 :set 命令可以设置选项。基本语法为：

* `:set option`         设置选项 option 

## 常见的功能选项包括：
* `autoindent`          设置该选项，则正文自动缩进 
* `ignorecase`         设置该选项，则忽略规则表达式中大小写字母的区别 
* `number`              设置该选项，则显示正文行号 
* `ruler`                   设置该选项，则在屏幕底部显示光标所在行、列的位置 
* `tabstop`               设置按 Tab 键跳过的空格数。例如 :set tabstop=n，n 默认值为 8 
* `mk`                      将选项保存在当前目录的 .exrc 文件中 