## 协议的“层次”   
   
网络是一个非常复杂系统，它的层次非常多，包括各种各样的主机/计算机，路由器，还有各种介质的链路，应用协议，应用程序，各种硬件，软件种类都在不断丰富，在这个过程当中，这么复杂问题我们要借助一个讨论用的平台，将这个平台的问题分成一个个的层次，分层的目的就是为了我们讨论的问题有确切的着眼点。  

#### 类似航空旅行的组织和运作过程： 
    `ticket(purchase)` ——> `baggage(check)` ——> `gates(load)` ——> `runway takeoff` ——> `airplane routing`   
     ———ING———>   
    `airplane routing` ——> `runway landing` ——> `gates(unload)` ——> `baggage(claim)` ——> `ticket(complain)`    
换一种角度，我们会发现每一层次的工作都有一个对应点，买票要去售票处，不同的航空公司是有不同的售票处的，当你到了对方的机场以后，你要到对方的机场，不同的航空公司也有不同的事务办案所，你要投诉，就要去相应的地方才能找到人；另外行李的托运和提取也是有一定的机构来保障的；登机和下飞机，每个机场都有一定的程序和规则而且几乎是一样的；起飞和降落巡航就是专业的运输过程。
在这个过程中，航空的运作就是有次序的，不可能越过某一个阶段直接进入另一个阶段。   
&nbsp;&nbsp;&nbsp;&nbsp;层次：每个层次实现一种服务，即每个层次都有其专业分工，除此之外还有一个顺序问题，即每个层次做这个事务之时的前提就是之前的工作都已经做完了才能到这个步骤。  
&nbsp;&nbsp;&nbsp;&nbsp;虽然这些层次有些对等的功能要做，但是其对等的功能实现是分步式的，或许登机的方式变更：登机桥/大巴拉到飞机下/自己拖行李？或许中间有转机的过程？所以可能服务程序、旅行质量产生变化，可是最终旅行的目的却是到达了的。   
#### 分层的原因  
对于复杂的系统：  
* 显式的结构使得复杂系统的问题定位和不同组成部分之间的关联讨论成为可能，即reference model参考模型的产生   
* 模块化简化了系统的维护和升级，每个层次服务实现对系统的其余部分是透明的 
* 分层的做法也是有一定弊端的：首先它很复杂，在我的大学网络学习中老师仍然过分要求七层模型等，等毕业了就只记得模型，越学越糊涂成为很多网络学生，乃至生产一线的人士烦恼。  &nbsp;其次层次之间功能有重合部分，造成了非常多资源的浪费。 

## 计算机网络的原理体系结构（**因特网协议栈**） 
**OSI七层，TCP/IP五层**  
  
* 应用层(application)：支持网络应用，FTP,SMTP,HTTP  ——————>+
* 传输层(transport)：主机进程间的数据传递，TCP，UDP  
* 网络层(network)：将数据报包从信源传递到信宿，IP，路由选择协议 
* 链路层(link)：数据在网络上的相邻结点间的传输，PPP,ethernet  
* 物理层(physical)：信道上传送的位流     
#### 分层：逻辑通信  
在每个层次上都会有一些分布的实体正在运行，实体在每一个结点上实现了一些相关的功能，实体在实现本身的一些操作，还要与对等的实体进行交换信息。网络端点上的每个实体都实现了数据传输的五层协议，而负责中转的交换结点/路由器上只需要实现最底层的三层，当应用层通过传输层需要产生通讯时，会将信息通过封装发到对应的线路进行传输，当对方的传输层接收到此信息时，一方面将接收到的数据传递给应用层，另一方面，它将返回响应告知发送端的传输层已经收到的信息，即是可靠传输，事前请示事后汇报  
#### 分层：物理通信  
所有的逻辑通信都将落实到物理通讯才能实现    
### 协议的分层和数据的封装  
前边已经见过，每个层次都从上层取得数据，然后加上首部信息形成新的数据单元传递给下一层，    
应用层(application)传输的报文称为`message`，    
经过传输层(transport))加上**Ht**报头后的报文称为`segment`，    
然后经过网络层(network)加上报头**Hn**后称为`datagram`,   
然后经过链路层(link)加上首部信息**Hl**后称为`frame`   
最后经过物理层physical进行信息传输。网络层中数据传输的单位是分组或者包，在TCP/IP协议中叫作数据报packet，链路层传输的数据单位就是frame，在物理层就转换为Byte(0/1)。   
## 因特网的结构  
* 松散的层次结构    
* 国家/国际骨干网络提供商(national/international&nbsp;backbone&basp;providers,NBP),网络运营商也是分级别的，因特网是由各种各样的企业完全商业化国际间营运的一个网络，比如：BBM/GTE,IBM,Sprint,AT&T,UUNet。每一个运营商都管理一大片网络，最后组成Internet。国际级的网络营运商NBP&nbsp;B/NBP&nbsp;A之下又有很多区域级的regional&nbsp;ISP，(华北网，西北网)，其中又包含许多的本地的local&nbsp;ISP。  
* 网络间只有连接在一起才能起到联通的效果，不能qiang,网络间对等体可以采用专用的方式，或者更多的网络通过公共网络访问点(Network&nbsp; Access&nbsp; Point,NAP互联)  
* 因特网的简史，了解一点彩蛋，1972年，在TCP之前主机间进行通信的第一个协议叫作NCP，NetworkControlProtocol。同年首个电子邮件程序运行，从1969年首个ARP_Anet结点运行，到72年ARP向公众展示已经有了15个结点，79年已经达到200个结点。1972-1980期间，出现了网络互联，出现了许多新型的，许多厂商的网络，82年定义了SMTP的E-mail协议，83年开始使用TCP/IP，同年定义了DNS用于name-to-IP-address转换就有了域名解析服务器，85年定义了FTP,88年开始考虑TCP的拥塞问题，加入了十万台主机，90年代初ARP退役，WWW万维网发展,超文本链接THML,等出现，91年允许网络商业化开始，94年网景公司图文并茂的浏览器诞生一下子引起了社会的关注，因特网就真的发展起来了，等等历史，有兴趣可自己查查看。  
<br>
本部分是承接上一部分的课程，做了很多方面的覆盖，网络的协议、边缘、核心、性能、模型、骨干、简史  
（2017-09-03 01:57）
